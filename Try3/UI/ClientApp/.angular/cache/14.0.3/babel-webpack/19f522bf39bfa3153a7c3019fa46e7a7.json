{"ast":null,"code":"// ExtensionCodec to handle MessagePack extensions\nimport { ExtData } from \"./ExtData.mjs\";\nimport { timestampExtension } from \"./timestamp.mjs\";\n\nvar ExtensionCodec =\n/** @class */\nfunction () {\n  function ExtensionCodec() {\n    // built-in extensions\n    this.builtInEncoders = [];\n    this.builtInDecoders = []; // custom extensions\n\n    this.encoders = [];\n    this.decoders = [];\n    this.register(timestampExtension);\n  }\n\n  ExtensionCodec.prototype.register = function (_a) {\n    var type = _a.type,\n        encode = _a.encode,\n        decode = _a.decode;\n\n    if (type >= 0) {\n      // custom extensions\n      this.encoders[type] = encode;\n      this.decoders[type] = decode;\n    } else {\n      // built-in extensions\n      var index = 1 + type;\n      this.builtInEncoders[index] = encode;\n      this.builtInDecoders[index] = decode;\n    }\n  };\n\n  ExtensionCodec.prototype.tryToEncode = function (object, context) {\n    // built-in extensions\n    for (var i = 0; i < this.builtInEncoders.length; i++) {\n      var encodeExt = this.builtInEncoders[i];\n\n      if (encodeExt != null) {\n        var data = encodeExt(object, context);\n\n        if (data != null) {\n          var type = -1 - i;\n          return new ExtData(type, data);\n        }\n      }\n    } // custom extensions\n\n\n    for (var i = 0; i < this.encoders.length; i++) {\n      var encodeExt = this.encoders[i];\n\n      if (encodeExt != null) {\n        var data = encodeExt(object, context);\n\n        if (data != null) {\n          var type = i;\n          return new ExtData(type, data);\n        }\n      }\n    }\n\n    if (object instanceof ExtData) {\n      // to keep ExtData as is\n      return object;\n    }\n\n    return null;\n  };\n\n  ExtensionCodec.prototype.decode = function (data, type, context) {\n    var decodeExt = type < 0 ? this.builtInDecoders[-1 - type] : this.decoders[type];\n\n    if (decodeExt) {\n      return decodeExt(data, type, context);\n    } else {\n      // decode() does not fail, returns ExtData instead.\n      return new ExtData(type, data);\n    }\n  };\n\n  ExtensionCodec.defaultCodec = new ExtensionCodec();\n  return ExtensionCodec;\n}();\n\nexport { ExtensionCodec };","map":{"version":3,"names":["ExtData","timestampExtension","ExtensionCodec","builtInEncoders","builtInDecoders","encoders","decoders","register","prototype","_a","type","encode","decode","index","tryToEncode","object","context","i","length","encodeExt","data","decodeExt","defaultCodec"],"sources":["D:/Source/Repos/Chat/Try3/UI/ClientApp/node_modules/@msgpack/msgpack/dist.es5+esm/ExtensionCodec.mjs"],"sourcesContent":["// ExtensionCodec to handle MessagePack extensions\nimport { ExtData } from \"./ExtData.mjs\";\nimport { timestampExtension } from \"./timestamp.mjs\";\nvar ExtensionCodec = /** @class */ (function () {\n    function ExtensionCodec() {\n        // built-in extensions\n        this.builtInEncoders = [];\n        this.builtInDecoders = [];\n        // custom extensions\n        this.encoders = [];\n        this.decoders = [];\n        this.register(timestampExtension);\n    }\n    ExtensionCodec.prototype.register = function (_a) {\n        var type = _a.type, encode = _a.encode, decode = _a.decode;\n        if (type >= 0) {\n            // custom extensions\n            this.encoders[type] = encode;\n            this.decoders[type] = decode;\n        }\n        else {\n            // built-in extensions\n            var index = 1 + type;\n            this.builtInEncoders[index] = encode;\n            this.builtInDecoders[index] = decode;\n        }\n    };\n    ExtensionCodec.prototype.tryToEncode = function (object, context) {\n        // built-in extensions\n        for (var i = 0; i < this.builtInEncoders.length; i++) {\n            var encodeExt = this.builtInEncoders[i];\n            if (encodeExt != null) {\n                var data = encodeExt(object, context);\n                if (data != null) {\n                    var type = -1 - i;\n                    return new ExtData(type, data);\n                }\n            }\n        }\n        // custom extensions\n        for (var i = 0; i < this.encoders.length; i++) {\n            var encodeExt = this.encoders[i];\n            if (encodeExt != null) {\n                var data = encodeExt(object, context);\n                if (data != null) {\n                    var type = i;\n                    return new ExtData(type, data);\n                }\n            }\n        }\n        if (object instanceof ExtData) {\n            // to keep ExtData as is\n            return object;\n        }\n        return null;\n    };\n    ExtensionCodec.prototype.decode = function (data, type, context) {\n        var decodeExt = type < 0 ? this.builtInDecoders[-1 - type] : this.decoders[type];\n        if (decodeExt) {\n            return decodeExt(data, type, context);\n        }\n        else {\n            // decode() does not fail, returns ExtData instead.\n            return new ExtData(type, data);\n        }\n    };\n    ExtensionCodec.defaultCodec = new ExtensionCodec();\n    return ExtensionCodec;\n}());\nexport { ExtensionCodec };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}